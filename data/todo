migrate compute range to c++
